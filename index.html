<!DOCTYPE html>
<meta charset="utf-8">
<title>2019 台灣政府預算-階層式長條圖</title>
<link rel="stylesheet" type="text/css" href="./inspector.css">
<link rel="stylesheet" type="text/css" href="./styles.css">

<body>
  <main class="page">
    <div id="intro"></div>
    <div class="controls">
      <label for="label-font-size">左側標籤字體大小：</label>
      <input type="range" id="label-font-size" name="label-font-size" min="10" max="24" value="16" />
      <span id="label-font-size-value">16px</span>

      <label for="margin-left" style="margin-left: 20px;">左側空間寬度：</label>
      <input type="range" id="margin-left" name="margin-left" min="100" max="600" value="350" />
      <span id="margin-left-value">350px</span>
      <span style="color: #888; font-size: 12px; margin-left: 8px;">（調整後會回到最上層）</span>
    </div>
    <div id="chart"></div>
    <p class="unit-note">數值單位：M = 百萬，G = 十億</p>
  </main>

  <script type="module">

    import define from "./index.js";
    import { Runtime, Library, Inspector } from "./runtime.js";

    const runtime = new Runtime();
    const main = runtime.module(define, name => {
      if (name === "intro") return Inspector.into(document.querySelector("#intro"))();
      if (name === "chart") return Inspector.into(document.querySelector("#chart"))();
      return null;
    });

    const labelFontSizeInput = document.getElementById("label-font-size");
    const labelFontSizeValue = document.getElementById("label-font-size-value");
    const updateLabelFontSize = (value) => {
      const size = `${value}px`;
      document.documentElement.style.setProperty("--bar-label-size", size);
      labelFontSizeValue.textContent = size;
    };

    labelFontSizeInput.addEventListener("input", (event) => {
      updateLabelFontSize(event.target.value);
    });

    updateLabelFontSize(labelFontSizeInput.value);

    // 左側空間寬度控制
    const marginLeftInput = document.getElementById("margin-left");
    const marginLeftValue = document.getElementById("margin-left-value");
    const updateMarginLeft = (value) => {
      const px = `${value}px`;
      marginLeftValue.textContent = px;
      main.redefine("marginLeft", parseInt(value));
    };

    marginLeftInput.addEventListener("input", (event) => {
      updateMarginLeft(event.target.value);
    });

  </script>